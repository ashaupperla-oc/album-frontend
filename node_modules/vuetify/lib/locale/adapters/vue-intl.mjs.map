{"version":3,"sources":["../../../src/locale/adapters/vue-intl.ts"],"names":["ref","wrapScope","scope","current","locale","fallback","defaultLocale","messages","t","id","params","formatMessage","reduce","obj","value","index","n","formatNumber","createVueIntlAdapter","createIntl","useIntl","provideIntl","rest","createRoot","getScope","createScope","props","newScope","fallbackLocale"],"mappings":"AAAA,SAASA,GAAT,QAAoB,KAApB;;AAeA,SAASC,SAAT,CAAoBC,KAApB,EAA8D;AAC5D,QAAMC,OAAO,GAAGH,GAAG,CAACE,KAAK,CAACE,MAAP,CAAnB;AACA,QAAMC,QAAQ,GAAGL,GAAG,CAACE,KAAK,CAACI,aAAP,CAApB;AACA,QAAMC,QAAQ,GAAGP,GAAG,CAACE,KAAK,CAACK,QAAP,CAApB;AAEA,SAAO;AACLJ,IAAAA,OADK;AAELE,IAAAA,QAFK;AAGLE,IAAAA,QAAQ,EAAEA,QAHL;AAILC,IAAAA,CAAC,EAAE,UAACC,EAAD,EAAmB;AAAA,wCAAXC,MAAW;AAAXA,QAAAA,MAAW;AAAA;;AACpB,aAAOR,KAAK,CAACS,aAAN,CAAoB;AAAEF,QAAAA;AAAF,OAApB,EAA4BC,MAAM,CAACE,MAAP,CAAuC,CAACC,GAAD,EAAMC,KAAN,EAAaC,KAAb,MAAwB,EAAE,GAAGF,GAAL;AAAU,SAACE,KAAD,GAASD;AAAnB,OAAxB,CAAvC,EAA4F,EAA5F,CAA5B,CAAP;AACD,KANI;AAOLE,IAAAA,CAAC,EAAEF,KAAK,IAAIZ,KAAK,CAACe,YAAN,CAAmBH,KAAnB;AAPP,GAAP;AASD;AAED;AACA;AACA;;;AACA,OAAO,SAASI,oBAAT,OAQiD;AAAA,MARlB;AACpCC,IAAAA,UADoC;AAEpCC,IAAAA,OAFoC;AAGpCC,IAAAA,WAHoC;AAIpCjB,IAAAA,MAJoC;AAKpCE,IAAAA,aALoC;AAMpCC,IAAAA,QANoC;AAOpC,OAAGe;AAPiC,GAQkB;AACtD,SAAO;AACLC,IAAAA,UAAU,EAAE,MAAM;AAChB,aAAOtB,SAAS,CAACkB,UAAU,CAAC;AAC1Bf,QAAAA,MAD0B;AAE1BE,QAAAA,aAF0B;AAG1BC,QAAAA,QAAQ,EAAEA,QAAQ,CAACH,MAAD;AAHQ,OAAD,CAAX,CAAhB;AAKD,KAPI;AAQLoB,IAAAA,QAAQ,EAAE,MAAM;AACd,YAAMtB,KAAK,GAAGkB,OAAO,EAArB;AACA,aAAOnB,SAAS,CAACC,KAAD,CAAhB;AACD,KAXI;AAYLuB,IAAAA,WAAW,EAAE,YAAgB;AAAA;;AAAA,UAAfC,KAAe,uEAAP,EAAO;AAC3B,YAAMC,QAAQ,GAAGR,UAAU,CAAC;AAC1Bf,QAAAA,MAAM,mBAAEsB,KAAK,CAACtB,MAAR,4BAAkBA,MADE;AAE1BE,QAAAA,aAAa,2BAAEoB,KAAK,CAACE,cAAR,oCAA0BtB,aAFb;AAG1BC,QAAAA,QAAQ,EAAEA,QAAQ,mBAACmB,KAAK,CAACtB,MAAP,6BAAiBA,MAAjB;AAHQ,OAAD,CAA3B;AAMAiB,MAAAA,WAAW,CAACM,QAAD,CAAX;AAEA,aAAO1B,SAAS,CAAC0B,QAAD,CAAhB;AACD,KAtBI;AAuBL,OAAGL;AAvBE,GAAP;AAyBD","sourcesContent":["import { ref } from 'vue'\n\nimport type { LocaleAdapter, LocaleInstance } from '@/composables/locale'\nimport type { RtlOptions } from '@/composables/rtl'\nimport type { createIntl, IntlShape } from '@formatjs/intl'\n\ntype VueIntlAdapterOptions = {\n  createIntl: typeof createIntl\n  useIntl: any\n  provideIntl: any\n  locale: string\n  defaultLocale: string\n  messages: Record<string, Record<string, string>>\n} & RtlOptions\n\nfunction wrapScope (scope: IntlShape<string>): LocaleInstance {\n  const current = ref(scope.locale)\n  const fallback = ref(scope.defaultLocale)\n  const messages = ref(scope.messages)\n\n  return {\n    current,\n    fallback,\n    messages: messages as any,\n    t: (id, ...params) => {\n      return scope.formatMessage({ id }, params.reduce<Record<string, unknown>>((obj, value, index) => ({ ...obj, [index]: value }), {}))\n    },\n    n: value => scope.formatNumber(value),\n  }\n}\n\n/**\n * There is no reactivity in this adapter, because vue-intl package does not seem to support it\n */\nexport function createVueIntlAdapter ({\n  createIntl,\n  useIntl,\n  provideIntl,\n  locale,\n  defaultLocale,\n  messages,\n  ...rest\n}: VueIntlAdapterOptions): (LocaleAdapter & RtlOptions) {\n  return {\n    createRoot: () => {\n      return wrapScope(createIntl({\n        locale,\n        defaultLocale,\n        messages: messages[locale],\n      }))\n    },\n    getScope: () => {\n      const scope = useIntl()\n      return wrapScope(scope)\n    },\n    createScope: (props = {}) => {\n      const newScope = createIntl({\n        locale: props.locale ?? locale,\n        defaultLocale: props.fallbackLocale ?? defaultLocale,\n        messages: messages[props.locale ?? locale],\n      })\n\n      provideIntl(newScope)\n\n      return wrapScope(newScope)\n    },\n    ...rest,\n  }\n}\n"],"file":"vue-intl.mjs"}