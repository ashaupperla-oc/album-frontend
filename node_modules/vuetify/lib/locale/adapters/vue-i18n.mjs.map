{"version":3,"sources":["../../../src/locale/adapters/vue-i18n.ts"],"names":["computed","watch","wrapScope","scope","current","locale","fallback","fallbackLocale","value","messages","t","n","createVueI18nAdapter","i18n","useI18n","rest","createRoot","global","getScope","legacy","useScope","createScope","props","inheritLocale"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,KAAnB,QAAgC,KAAhC,C,CAEA;;AAUA,SAASC,SAAT,CAAoBC,KAApB,EAAqD;AACnD,SAAO;AACLC,IAAAA,OAAO,EAAED,KAAK,CAACE,MADV;AAELC,IAAAA,QAAQ,EAAEN,QAAQ,CAAC,MAAM;AACvB;AACA,aAAO,OAAOG,KAAK,CAACI,cAAN,CAAqBC,KAA5B,KAAsC,QAAtC,GAAiD,IAAjD,GACHL,KAAK,CAACI,cAAN,CAAqBC,KADzB;AAED,KAJiB,CAFb;AAOL;AACAC,IAAAA,QAAQ,EAAEN,KAAK,CAACM,QARX;AASLC,IAAAA,CAAC,EAAEP,KAAK,CAACO,CATJ;AAULC,IAAAA,CAAC,EAAER,KAAK,CAACQ;AAVJ,GAAP;AAYD;;AAED,OAAO,SAASC,oBAAT,OAA+G;AAAA,MAAhF;AAAEC,IAAAA,IAAF;AAAQC,IAAAA,OAAR;AAAiB,OAAGC;AAApB,GAAgF;AACpH,SAAO;AACLC,IAAAA,UAAU,EAAE,MAAM;AAChB,aAAOd,SAAS,CAACW,IAAI,CAACI,MAAN,CAAhB;AACD,KAHI;AAILC,IAAAA,QAAQ,EAAE,MAAM;AACd,YAAMf,KAAK,GAAGW,OAAO,CAAC;AAAEK,QAAAA,MAAM,EAAE,KAAV;AAAiBC,QAAAA,QAAQ,EAAE;AAA3B,OAAD,CAArB;AAEA,aAAOlB,SAAS,CAACC,KAAD,CAAhB;AACD,KARI;AASLkB,IAAAA,WAAW,EAAE,YAAgB;AAAA;;AAAA,UAAfC,KAAe,uEAAP,EAAO;AAC3B,YAAMnB,KAAK,GAAGW,OAAO,CAAC;AACpBK,QAAAA,MAAM,EAAE,KADY;AAEpBC,QAAAA,QAAQ,EAAE,OAFU;AAGpBX,QAAAA,QAAQ,qBAAGa,KAAK,CAACb,QAAT,8BAAqBI,IAAI,CAACI,MAAL,CAAYR,QAHrB;AAGuC;AAC3DJ,QAAAA,MAAM,EAAEiB,KAAK,CAACjB,MAJM;AAKpBE,QAAAA,cAAc,EAAEe,KAAK,CAACf,cALF;AAMpBgB,QAAAA,aAAa,EAAE,CAACD,KAAK,CAACjB;AANF,OAAD,CAArB;AASAJ,MAAAA,KAAK,CAAC,MAAMqB,KAAK,CAACjB,MAAb,EAAqB,MAAM;AAC9B,YAAIiB,KAAK,CAACjB,MAAV,EAAkB;AAChBF,UAAAA,KAAK,CAACE,MAAN,CAAaG,KAAb,GAAqBc,KAAK,CAACjB,MAA3B;AACD,SAFD,MAEO;AACLF,UAAAA,KAAK,CAACoB,aAAN,GAAsB,IAAtB;AACD;AACF,OANI,CAAL;AAQAtB,MAAAA,KAAK,CAAC,MAAMqB,KAAK,CAACf,cAAb,EAA6B,MAAM;AACtC,YAAIe,KAAK,CAACf,cAAV,EAA0B;AACxBJ,UAAAA,KAAK,CAACI,cAAN,CAAqBC,KAArB,GAA6Bc,KAAK,CAACf,cAAnC;AACD;AACF,OAJI,CAAL;AAMA,aAAOL,SAAS,CAACC,KAAD,CAAhB;AACD,KAlCI;AAmCL,OAAGY;AAnCE,GAAP;AAqCD","sourcesContent":["import { computed, watch } from 'vue'\n\n// Types\nimport type { Composer, I18n, useI18n } from 'vue-i18n'\nimport type { LocaleAdapter, LocaleInstance } from '@/composables/locale'\nimport type { RtlOptions } from '@/composables/rtl'\n\ntype VueI18nAdapterParams = {\n  i18n: I18n<{}, {}, {}, string, false>\n  useI18n: typeof useI18n\n} & RtlOptions\n\nfunction wrapScope (scope: Composer): LocaleInstance {\n  return {\n    current: scope.locale,\n    fallback: computed(() => {\n      // TODO: Handle this better?\n      return typeof scope.fallbackLocale.value !== 'string' ? 'en'\n        : scope.fallbackLocale.value\n    }),\n    // TODO: Can this be fixed?\n    messages: scope.messages as any,\n    t: scope.t,\n    n: scope.n,\n  }\n}\n\nexport function createVueI18nAdapter ({ i18n, useI18n, ...rest }: VueI18nAdapterParams): (LocaleAdapter & RtlOptions) {\n  return {\n    createRoot: () => {\n      return wrapScope(i18n.global)\n    },\n    getScope: () => {\n      const scope = useI18n({ legacy: false, useScope: 'parent' }) as Composer\n\n      return wrapScope(scope)\n    },\n    createScope: (props = {}) => {\n      const scope = useI18n({\n        legacy: false,\n        useScope: 'local',\n        messages: (props.messages ?? i18n.global.messages) as any, // TODO: Fix this\n        locale: props.locale,\n        fallbackLocale: props.fallbackLocale,\n        inheritLocale: !props.locale,\n      }) as Composer\n\n      watch(() => props.locale, () => {\n        if (props.locale) {\n          scope.locale.value = props.locale\n        } else {\n          scope.inheritLocale = true\n        }\n      })\n\n      watch(() => props.fallbackLocale, () => {\n        if (props.fallbackLocale) {\n          scope.fallbackLocale.value = props.fallbackLocale\n        }\n      })\n\n      return wrapScope(scope)\n    },\n    ...rest,\n  }\n}\n"],"file":"vue-i18n.mjs"}