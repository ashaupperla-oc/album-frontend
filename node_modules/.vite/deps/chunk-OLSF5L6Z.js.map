{
  "version": 3,
  "sources": ["../../vuetify/src/components/VImg/VImg.tsx", "../../vuetify/src/components/VResponsive/VResponsive.tsx"],
  "sourcesContent": ["import './VImg.sass'\n\n// Components\nimport { VResponsive } from '@/components/VResponsive'\n\n// Directives\nimport intersect from '@/directives/intersect'\n\n// Composables\nimport { makeTransitionProps, MaybeTransition } from '@/composables/transition'\n\n// Utilities\nimport {\n  computed,\n  h,\n  nextTick,\n  onBeforeMount,\n  ref,\n  vShow,\n  watch,\n  withDirectives,\n} from 'vue'\nimport {\n  convertToUnit,\n  defineComponent,\n  SUPPORTS_INTERSECTION,\n  useRender,\n} from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\n\n// not intended for public use, this is passed in by vuetify-loader\nexport interface srcObject {\n  src?: string\n  srcset?: string\n  lazySrc?: string\n  aspect: number\n}\n\nexport const VImg = defineComponent({\n  name: 'VImg',\n\n  directives: { intersect },\n\n  props: {\n    aspectRatio: [String, Number],\n    alt: String,\n    cover: Boolean,\n    eager: Boolean,\n    gradient: String,\n    lazySrc: String,\n    options: {\n      type: Object as PropType<IntersectionObserverInit>,\n      // For more information on types, navigate to:\n      // https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API\n      default: () => ({\n        root: undefined,\n        rootMargin: undefined,\n        threshold: undefined,\n      }),\n    },\n    sizes: String,\n    src: {\n      type: [String, Object] as PropType<string | srcObject>,\n      default: '',\n    },\n    srcset: String,\n    width: [String, Number],\n\n    ...makeTransitionProps(),\n  },\n\n  emits: ['loadstart', 'load', 'error'],\n\n  setup (props, { emit, slots }) {\n    const currentSrc = ref('') // Set from srcset\n    const image = ref<HTMLImageElement>()\n    const state = ref<'idle' | 'loading' | 'loaded' | 'error'>(props.eager ? 'loading' : 'idle')\n    const naturalWidth = ref<number>()\n    const naturalHeight = ref<number>()\n\n    const normalisedSrc = computed<srcObject>(() => {\n      return props.src && typeof props.src === 'object'\n        ? {\n          src: props.src.src,\n          srcset: props.srcset || props.src.srcset,\n          lazySrc: props.lazySrc || props.src.lazySrc,\n          aspect: Number(props.aspectRatio || props.src.aspect),\n        } : {\n          src: props.src,\n          srcset: props.srcset,\n          lazySrc: props.lazySrc,\n          aspect: Number(props.aspectRatio || 0),\n        }\n    })\n    const aspectRatio = computed(() => {\n      return normalisedSrc.value.aspect || naturalWidth.value! / naturalHeight.value! || 0\n    })\n\n    watch(() => props.src, () => {\n      init(state.value !== 'idle')\n    })\n    // TODO: getSrc when window width changes\n\n    onBeforeMount(() => init())\n\n    function init (isIntersecting?: boolean) {\n      if (props.eager && isIntersecting) return\n      if (\n        SUPPORTS_INTERSECTION &&\n        !isIntersecting &&\n        !props.eager\n      ) return\n\n      state.value = 'loading'\n\n      if (normalisedSrc.value.lazySrc) {\n        const lazyImg = new Image()\n        lazyImg.src = normalisedSrc.value.lazySrc\n        pollForSize(lazyImg, null)\n      }\n\n      if (!normalisedSrc.value.src) return\n\n      nextTick(() => {\n        emit('loadstart', image.value?.currentSrc || normalisedSrc.value.src)\n\n        if (image.value?.complete) {\n          if (!image.value.naturalWidth) {\n            onError()\n          }\n\n          if (state.value === 'error') return\n\n          if (!aspectRatio.value) pollForSize(image.value, null)\n          onLoad()\n        } else {\n          if (!aspectRatio.value) pollForSize(image.value!)\n          getSrc()\n        }\n      })\n    }\n\n    function onLoad () {\n      getSrc()\n      state.value = 'loaded'\n      emit('load', image.value?.currentSrc || normalisedSrc.value.src)\n    }\n\n    function onError () {\n      state.value = 'error'\n      emit('error', image.value?.currentSrc || normalisedSrc.value.src)\n    }\n\n    function getSrc () {\n      const img = image.value\n      if (img) currentSrc.value = img.currentSrc || img.src\n    }\n\n    function pollForSize (img: HTMLImageElement, timeout: number | null = 100) {\n      const poll = () => {\n        const { naturalHeight: imgHeight, naturalWidth: imgWidth } = img\n\n        if (imgHeight || imgWidth) {\n          naturalWidth.value = imgWidth\n          naturalHeight.value = imgHeight\n        } else if (!img.complete && state.value === 'loading' && timeout != null) {\n          setTimeout(poll, timeout)\n        } else if (img.currentSrc.endsWith('.svg') || img.currentSrc.startsWith('data:image/svg+xml')) {\n          naturalWidth.value = 1\n          naturalHeight.value = 1\n        }\n      }\n\n      poll()\n    }\n\n    const containClasses = computed(() => ({\n      'v-img__img--cover': props.cover,\n      'v-img__img--contain': !props.cover,\n    }))\n\n    const __image = computed(() => {\n      if (!normalisedSrc.value.src || state.value === 'idle') return\n\n      const img = h('img', {\n        class: ['v-img__img', containClasses.value],\n        src: normalisedSrc.value.src,\n        srcset: normalisedSrc.value.srcset,\n        sizes: props.sizes,\n        ref: image,\n        onLoad,\n        onError,\n      })\n\n      const sources = slots.sources?.()\n\n      return (\n        <MaybeTransition transition={ props.transition } appear>\n          {\n            withDirectives(\n              sources\n                ? <picture class=\"v-img__picture\">{ sources }{ img }</picture>\n                : img,\n              [[vShow, state.value === 'loaded']]\n            )\n          }\n        </MaybeTransition>\n      )\n    })\n\n    const __preloadImage = computed(() => (\n      <MaybeTransition transition={ props.transition }>\n        { normalisedSrc.value.lazySrc && state.value !== 'loaded' && (\n          <img\n            class={['v-img__img', 'v-img__img--preload', containClasses.value]}\n            src={ normalisedSrc.value.lazySrc }\n            alt=\"\"\n          />\n        )}\n      </MaybeTransition>\n    ))\n\n    const __placeholder = computed(() => {\n      if (!slots.placeholder) return\n\n      return (\n        <MaybeTransition transition={ props.transition } appear>\n          { (state.value === 'loading' || (state.value === 'error' && !slots.error)) &&\n          <div class=\"v-img__placeholder\">{ slots.placeholder() }</div>\n          }\n        </MaybeTransition>\n      )\n    })\n\n    const __error = computed(() => {\n      if (!slots.error) return\n\n      return (\n        <MaybeTransition transition={ props.transition } appear>\n          { state.value === 'error' &&\n            <div class=\"v-img__error\">{ slots.error() }</div>\n          }\n        </MaybeTransition>\n      )\n    })\n\n    const __gradient = computed(() => {\n      if (!props.gradient) return\n\n      return <div class=\"v-img__gradient\" style={{ backgroundImage: `linear-gradient(${props.gradient})` }} />\n    })\n\n    const isBooted = ref(false)\n    {\n      const stop = watch(aspectRatio, val => {\n        if (val) {\n          // Doesn't work with nextTick, idk why\n          requestAnimationFrame(() => {\n            requestAnimationFrame(() => {\n              isBooted.value = true\n            })\n          })\n          stop()\n        }\n      })\n    }\n\n    useRender(() => (\n      <VResponsive\n        class={[\n          'v-img',\n          { 'v-img--booting': !isBooted.value },\n        ]}\n        style={{ width: convertToUnit(props.width === 'auto' ? naturalWidth.value : props.width) }}\n        aspectRatio={ aspectRatio.value }\n        aria-label={ props.alt }\n        role={ props.alt ? 'img' : undefined }\n        v-intersect={[{\n          handler: init,\n          options: props.options,\n        }, null, ['once']]}\n        v-slots={{\n          additional: () => [__image.value, __preloadImage.value, __gradient.value, __placeholder.value, __error.value],\n          default: slots.default,\n        }}\n      />\n    ))\n\n    return {\n      currentSrc,\n      image,\n      state,\n      naturalWidth,\n      naturalHeight,\n    }\n  },\n})\n\nexport type VImg = InstanceType<typeof VImg>\n", "// Styles\nimport './VResponsive.sass'\n\n// Composables\nimport { makeDimensionProps, useDimension } from '@/composables/dimensions'\n\n// Utilities\nimport { computed } from 'vue'\nimport { defineComponent } from '@/util'\n\nexport function useAspectStyles (props: { aspectRatio?: string | number }) {\n  return {\n    aspectStyles: computed(() => {\n      const ratio = Number(props.aspectRatio)\n\n      return ratio\n        ? { paddingBottom: String(1 / ratio * 100) + '%' }\n        : undefined\n    }),\n  }\n}\n\nexport const VResponsive = defineComponent({\n  name: 'VResponsive',\n\n  props: {\n    aspectRatio: [String, Number],\n    contentClass: String,\n\n    ...makeDimensionProps(),\n  },\n\n  setup (props, { slots }) {\n    const { dimensionStyles } = useDimension(props)\n    const { aspectStyles } = useAspectStyles(props)\n\n    return () => (\n      <div class=\"v-responsive\" style={ dimensionStyles.value }>\n        <div class=\"v-responsive__sizer\" style={ aspectStyles.value } />\n        { slots.additional?.() }\n        { slots.default && (\n          <div class={['v-responsive__content', props.contentClass]}>{ slots.default() }</div>\n        )}\n      </div>\n    )\n  },\n})\n"],
  "mappings": "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",
  "names": []
}
